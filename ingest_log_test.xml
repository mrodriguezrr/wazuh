## Step 1: Create the test log file
```bash
touch /var/ossec/logs/wazuh_test
chmod 660 /var/ossec/logs/wazuh_test
chown wazuh: /var/ossec/logs/wazuh_test
````

---

## Step 2: Configure log collection

Add to `/var/ossec/etc/ossec.conf`:

```xml
<localfile>
  <log_format>syslog</log_format>
  <location>/var/ossec/logs/wazuh_test</location>
</localfile>
```

---

## Step 3: Create custom decoders

`/var/ossec/etc/decoders/mysyslog-decoder.xml`

```xml
<decoder name="mysyslog-decoder">
  <program_name>myapp</program_name>
</decoder>

<decoder name="mysyslog-decoder">
  <parent>mysyslog-decoder</parent>
  <regex type="pcre2">User login failed for account "(\S+)"</regex>
  <order>account_name</order>
</decoder>

<decoder name="mysyslog-decoder">
  <parent>mysyslog-decoder</parent>
  <regex type="pcre2">from (\S+)</regex>
  <order>client_address</order>
</decoder>
```

---

## Step 4: Create custom rules

`/var/ossec/etc/rules/mysyslog-rules.xml`

```xml
<group name="wazuh_test,">
  <rule id="115700" level="0">
    <decoded_as>mysyslog-decoder</decoded_as>
    <description>Wazuh test "failed login" event found.</description>
  </rule>

  <rule id="115701" level="5">
    <if_sid>115700</if_sid>
    <field name="account_name">my-admin</field>
    <description>Wazuh rule test | Test user=$(account_name) from Test ip=$(client_address)</description>
  </rule>
</group>
```

---

## Step 5: Generate a test log

```bash
echo 'Sep 25 12:45:33 my-host myapp[1234]: User login failed for account "my-admin" from 10.0.0.5' >> /var/ossec/logs/wazuh_test
```

